<!DOCTYPE html>
<html>
<head>
    <title>Mini</title>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="./style.css"/>
</head>
<body>
<div class="type-bar">
    <span class="code-type">Code Type:</span>
    <button id="type-js" class="js current">JavaScript</button>
    <button id="type-css" class="css">CSS</button>
    <button id="type-html">HTML</button>
</div>
<div class="input">
    <textarea id="input-content"></textarea>
</div>
<div class="output">
    <textarea id="output-content"></textarea>
</div>
<script>
    (function(){
        "use strict";
        var ipc = require("ipc");

        function $(id) {
            return document.getElementById(id);
        }
        var inputTextArea = $('input-content');
        var outputTextArea = $('output-content');
        var compressTimeout = null;
        inputTextArea.addEventListener('input', function inputChange(){
            clearTimeout(compressTimeout);
            var code = this.value;
            compressTimeout = setTimeout(function(){
                ipc.send('compress', {
                    type: 'js',
                    code: code
                });
            }, 500);
        });

        ipc.on("compressed", function compressed(args) {
            outputTextArea.value = args.code;
        });

        var codeTypeArray = ["type-js", "type-css", "type-html"];

        function changeCodeType(){
            codeTypeArray.forEach(function(item){
                $(item).classList.remove('current');
            });
            this.classList.add('current');
        }

        codeTypeArray.forEach(function(item){
            $(item).addEventListener("click", changeCodeType);
        });
    })();
</script>
</body>
</html>
